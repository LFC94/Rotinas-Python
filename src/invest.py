import time

import numpy as np
import pandas as pd
import yfinance as yf
from deep_translator import GoogleTranslator

# from src.util.uteis import menuTelas


def buscar_dados_acao(ticker):
    """
    Busca dados de uma ação específica usando Yahoo Finance
    """
    try:
        # Adiciona .SA para ações brasileiras
        if not ticker.endswith('.SA'):
            ticker += '.SA'

        # Busca dados da ação
        acao = yf.Ticker(ticker)
        info = acao.info

        # Extrai informações relevantes
        dados = {
            'Nome': info.get('longName', ''),
            'Ticker': ticker.replace('.SA', ''),
            'CNPJ': info.get('cnpj', ''),
            'Setor': info.get('sector', ''),
            'Segmento': info.get('industry', ''),
            'Site': info.get('website', ''),
            'País': info.get('country', '')
        }

        return dados

    except Exception as e:
        print(f"Erro ao buscar dados para {ticker}: {e}")
        return None


def listar_acoes_brasileiras():
    """
    Retorna uma lista de ações brasileiras comuns
    """
    acoes_br = [
        'IBOV',
        'LIPR3',
        'SQIA3',
        'ANIM3',
        'MAPT4',
        'LPSB3',
        'BTOW3',
        'NORD3',
        'PRNR3',
        'MEAL3',
        'GOLL4',
        'GFSA3',
        'ECOR3',
        'RCSL4',
        'MILS3',
        'BRAP4',
        'TELB3',
        'BRAP3',
        'SUZB3',
        'IDVL4',
        'PMAM3',
        'BAHI3',
        'MGEL4',
        'AMAR3',
        'IDVL3',
        'HBOR3',
        'BIOM3',
        'BOBR4',
        'RANI4',
        'SPRI6',
        'CEDO3',
        'KLBN3',
        'KLBN4',
        'KLBN11',
        'VVAR3',
        'TCNO3',
        'PLAS3',
        'MSPA3',
        'SPRI5',
        'ETER3',
        'TELB4',
        'SPRI3',
        'RANI3',
        'TCNO4',
        'CTNM3',
        'BRKM5',
        'CRDE3',
        'BRKM3',
        'MNDL3',
        'MDNE3',
        'BRKM6',
        'CTKA3',
        'AHEB3',
        'CTKA4',
        'EMBR3',
        'DTCY3',
        'CEDO4',
        'AHEB5',
        'PINE4',
        'BSEV3',
        'DMMO3',
        'ADHM3',
        'CTNM4',
        'TCSA3',
        'AZUL4',
        'GSHP3',
        'LLIS3',
        'TESA3',
        'SHOW3',
        'RPMG3',
        'LUPA3',
        'CORR4',
        'BBRK3',
        'TPIS3',
        'MNPR3',
        'JBDU3',
        'HBTS5',
        'ESTR4',
        'TECN3',
        'OIBR4',
        'JFEN3',
        'JBDU4',
        'OIBR3',
        'IGBR3',
        'VIVR3',
        'HOOT4',
        'LIQO3',
        'RSID3',
        'SLED3',
        'MWET4',
        'AZEV3',
        'INEP3',
        'INEP4',
        'AZEV4',
        'BDLL4',
        'RNEW3',
        'SNSY5',
        'MMXM3',
        'SLED4',
        'RNEW11',
        'RNEW4',
        'PDGR3',
        'TEKA3',
        'TEKA4',
        'OSXB3',
        'BBSE3',
        'CSAB3',
        'CSAB4',
        'IRBR3',
        'TAEE11',
        'TAEE3',
        'TAEE4',
        'FHER3',
        'NUTR3',
        'HETA4',
        'MTIG4',
        'TXRX4',
        'GPIV33',
        'TXRX3',
        'LIGT3',
        'CEAB3',
        'SMLS3',
        'BAZA3',
        'ELET3',
        'RSUL4',
        'CGRA3',
        'BRSR6',
        'BNBR3',
        'CGRA4',
        'ELET6',
        'BSLI4',
        'BGIP4',
        'EALT4',
        'CMIG4',
        'CMIG3',
        'BRSR3',
        'BBAS3',
        'BMEB4',
        'CAMB3',
        'PRIO3',
        'CLSC4',
        'EKTR3',
        'ABCB4',
        'WHRL4',
        'MYPK3',
        'WHRL3',
        'GPCP3',
        'BMEB3',
        'BSLI3',
        'CRPG3',
        'PETR4',
        'CRPG6',
        'SGPS3',
        'CRPG5',
        'COCE3',
        'ELET5',
        'PETR3',
        'WIZS3',
        'CSNA3',
        'PTNT4',
        'BRGE12',
        'SANB3',
        'ALUP4',
        'BRML3',
        'SANB11',
        'EUCA4',
        'CESP6',
        'CEBR3',
        'EKTR4',
        'CESP3',
        'CESP5',
        'SANB4',
        'SAPR4',
        'TGMA3',
        'TRPL4',
        'FESA4',
        'VULC3',
        'SAPR11',
        'CRIV3',
        'CEBR6',
        'ITSA4',
        'BRSR5',
        'CPLE3',
        'BEES3',
        'BEES4',
        'BTTL3',
        'BBDC3',
        'TUPY3',
        'BMGB4',
        'ALUP11',
        'ENBR3',
        'TASA3',
        'CVCB3',
        'BRGE8',
        'CPLE6',
        'MTSA4',
        'SAPR3',
        'ROMI3',
        'BPAC5',
        'CEBR5',
        'JHSF3',
        'BGIP3',
        'BBDC4',
        'COCE5',
        'SHUL4',
        'TRPL3',
        'ITSA3',
        'SBSP3',
        'CSMG3',
        'LEVE3',
        'CRIV4',
        'TEND3',
        'CIEL3',
        'CAML3',
        'TASA4',
        'HAGA4',
        'WLMM3',
        'CBEE3',
        'MERC4',
        'ENMT3',
        'ENMT4',
        'NEOE3',
        'NEOE3',
        'TIMS3',
        'CEEB5',
        'BPAC11',
        'ELEK3',
        'ITUB3',
        'GUAR3',
        'ALUP3',
        'RAPT3',
        'BRIV3',
        'BRIV4',
        'CSAN3',
        'CEEB3',
        'FESA3',
        'FRIO3',
        'ITUB4',
        'CSRN3',
        'BRGE3',
        'WLMM4',
        'JBSS3',
        'MRVE3',
        'PSSA3',
        'TRIS3',
        'BRDT3',
        'HGTX3',
        'ELEK4',
        'DOHL4',
        'VLID3',
        'RPAD3',
        'RAPT4',
        'EQTL3',
        'BPAN4',
        'ENAT3',
        'BRGE11',
        'SMTO3',
        'NAFG3',
        'NAFG4',
        'EMAE4',
        'SULA4',
        'EVEN3',
        'GOAU3',
        'UNIP6',
        'LUXM4',
        'GRND3',
        'CPFE3',
        'POMO4',
        'POMO3',
        'GOAU4',
        'DIRR3',
        'RPAD6',
        'BRPR3',
        'MOVI3',
        'EGIE3',
        'YDUQ3',
        'JPSA3',
        'FRTA3',
        'BPAC3',
        'CYRE3',
        'EQPA3',
        'EALT3',
        'PARD3',
        'GEPA3',
        'GGBR3',
        'CARD3',
        'PEAB3',
        'PTNT3',
        'SULA11',
        'SEER3',
        'CGAS3',
        'CGAS5',
        'BALM4',
        'SLCE3',
        'BRGE6',
        'MOAR3',
        'UCAS3',
        'UNIP5',
        'ABEV3',
        'VIVA3',
        'HYPE3',
        'CTSA3',
        'GGBR4',
        'UNIP3',
        'RPAD5',
        'VIVT4',
        'VIVT3',
        'PEAB4',
        'DTEX3',
        'SIMH3',
        'GEPA4',
        'HAGA3',
        'IGTA3',
        'BAUH4',
        'QUAL3',
        'CCRO3',
        'WSON33',
        'SOND6',
        'AFLT3',
        'BALM3',
        'TIET4',
        'KEPL3',
        'CTSA4',
        'BEEF3',
        'ENEV3',
        'EUCA3',
        'ATOM3',
        'TIET11',
        'MDIA3',
        'SULA3',
        'LCAM3',
        'PATI3',
        'CNTO3',
        'SOND5',
        'MULT3',
        'FLRY3',
        'TIET3',
        'PCAR3',
        'SCAR3',
        'ARZZ3',
        'EZTC3',
        'FRAS3',
        'LOGG3',
        'PATI4',
        'JOPA4',
        'LREN3',
        'USIM5',
        'AALR3',
        'EQPA7',
        'B3SA3',
        'REDE3',
        'JOPA3',
        'OFSA3',
        'ODPV3',
        'RENT3',
        'USIM3',
        'EQPA5',
        'ENGI4',
        'BMKS3',
        'AGRO3',
        'PNVL4',
        'PTBL3',
        'MTRE3',
        'RLOG3',
        'ENGI11',
        'POSI3',
        'BMIN4',
        'IDNT3',
        'BMIN3',
        'CRFB3',
        'RAIL3',
        'COGN3',
        'MRFG3',
        'CEGR3',
        'PNVL3',
        'RADL3',
        'UGPA3',
        'BKBR3',
        'HAPV3',
        'ENGI3',
        'WEGE3',
        'ALPA3',
        'LAME3',
        'PFRM3',
        'BRFS3',
        'USIM6',
        'TOTS3',
        'EQPA6',
        'ALPA4',
        'LAME4',
        'CCPR3',
        'GNDI3',
        'BIDI3',
        'BIDI11',
        'APER3',
        'BIDI4',
        'MGLU3',
        'CPRE3',
        'LINX3',
        'LOGN3',
        'LWSA3',
        'STBP3',
        'RDNI3',
        'OMGE3',
        'NTCO3',
        'DASA3',
        'ALSO3',
        'VALE3',
        'GBIO33',
        'CEPE6',
        'CEPE5',
        'ALPK3',
        'LAVV3',
        'PLPL3',
        'MELK3',
        'HBSA3',
        'CURY3',
        'BOAS3',
        'SEQL3',
        'GMAT3',
        'PETZ3',
        'AMBP3',
        'DMVF3',
        'SOMA3',
        'LJQQ3',
        'PGMN3',
        'AERI3',
        'ENJU3',
        'CASH3',
        'RRRP3',
        'TFCO4',
        'RDOR3',
        'NGRD3',
        'BBSD11',
        'XBOV11',
        'BOVB11',
        'IVVB11',
        'BOVA11',
        'BRAX11',
        'ECOO11',
        'SMAL11',
        'BOVV11',
        'DIVO11',
        'FIND11',
        'GOVE11',
        'MATB11',
        'ISUS11',
        'PIBB11',
        'SMAC11',
        'SPXI11',
        'MMMC34',
        'ABUD34',
        'A1BB34',
        'ABTT34',
        'ABBV34',
        'A1BM34',
        'ATVI34',
        'ADBE34',
        'A1AP34',
        'A1MD34',
        'A1EG34',
        'A1ES34',
        'A1FL34',
        'A1GI34',
        'A1PD34',
        'A1KA34',
        'A1LK34',
        'A1LB34',
        'A1RE34',
        'A1LX34',
        'BABA34',
        'A1LG34',
        'A1GN34',
        'A1LL34',
        'A1EN34',
        'A1TT34',
        'A1LN34',
        'GOGL34',
        'GOGL35',
        'A1YX34',
        'MOOO34',
        'A1CR34',
        'A1EE34',
        'A1MX34',
        'AALL34',
        'A1EP34',
        'T1OW34',
        'A1WK34',
        'A1MP34',
        'A1MB34',
        'A1ME34',
        'AMGN34',
        'A1PH34',
        'A1DI34',
        'A1UA34',
        'A1NS34',
        'A1NT34',
        'A1OS34',
        'A1ON34',
        'A1PA34',
        'A1IV34',
        'AAPL34',
        'A1MT34',
        'APTV34',
        'ARMT34',
        'A1DM34',
        'A1RG34',
        'A1NE34',
        'AWII34',
        'A1JG34',
        'A1SN34',
        'ASML34',
        'A1SU34',
        'A1ZN34',
        'T1AM34',
        'A1TM34',
        'A1UT34',
        'A1TH34',
        'ADPR34',
        'AZOI34',
        'A1VB34',
        'A1VY34',
        'BIDU34',
        'B1KR34',
        'B1LL34',
        'B1SA34',
        'BOAC34',
        'B1CS34',
        'B1AX34',
        'B1BT34',
        'B1DX34',
        'B1GN34',
        'BBYY34',
        'BHPG34',
        'B1BL34',
        'BILB34',
        'B1IL34',
        'BIIB34',
        'B1MR34',
        'B1NT34',
        'T1CH34',
        'BLAK34',
        'BKNG34',
        'B1WA34',
        'BOXP34',
        'B1SX34',
        'B1PP34',
        'B1TI34',
        'AVGO34',
        'B1RF34',
        'B1AM34',
        'B1FC34',
        'C1AB34',
        'C1OG34',
        'C1DN34',
        'C1PB34',
        'CNIC34',
        'CPRL34',
        'CAJI34',
        'CAON34',
        'CAPH34',
        'C1AH34',
        'K1MX34',
        'C1CL34',
        'C1RR34',
        'CRIN34',
        'C1BO34',
        'C1BR34',
        'C1BS34',
        'C1DW34',
        'C1NS34',
        'C1NC34',
        'C1NP34',
        'C1ER34',
        'C1FI34',
        'C1HR34',
        'CHCM34',
        'C1HK34',
        'L1FC34',
        'C1HL34',
        'C1HI34',
        'C1MG34',
        'C1BL34',
        'C1HT34',
        'CHDC34',
        'C1IC34',
        'CINF34',
        'C1TA34',
        'CSCO34',
        'CTGP34',
        'C1FG34',
        'C1TX34',
        'CLXC34',
        'CHME34',
        'C1MS34',
        'C1EO34',
        'CTSH34',
        'CMCS34',
        'C1MA34',
        'C1AG34',
        'C1XO34',
        'E1DI34',
        'STZB34',
        'C1OO34',
        'C1PR34',
        'COPH34',
        'G1LW34',
        'C1TV34',
        'C1GP34',
        'COWC34',
        'COTY34',
        'C1OU34',
        'CRDA34',
        'C1SU34',
        'CRHP34',
        'C1CI34',
        'CSXC34',
        'CRIP34',
        'C1MI34',
        'CVSH34',
        'DHER34',
        'D1RI34',
        'D1DG34',
        'DVAI34',
        'DEEC34',
        'D1EL34',
        'DEAI34',
        'XRAY34',
        'DBAG34',
        'D1VN34',
        'D1EX34',
        'DEOP34',
        'F1AN34',
        'D1LR34',
        'D1FS34',
        'DCVY34',
        'DCVY35',
        'D1IS34',
        'D1OC34',
        'DGCO34',
        'DLTR34',
        'D1OM34',
        'D1OV34',
        'D1OW34',
        'D1HI34',
        'R1DY34',
        'D1TE34',
        'D1RE34',
        'D1XC34',
        'E1MN34',
        'E1TN34',
        'EBAY34',
        'E1CL34',
        'E1CO34',
        'E1IX34',
        'E1WL34',
        'EAIN34',
        'E1MR34',
        'E1NI34',
        'E1TR34',
        'E1OG34',
        'E1FX34',
        'EQIX34',
        'E1QN34',
        'E1QR34',
        'E1RI34',
        'E1SS34',
        'ELCI34',
        'E1VE34',
        'E1VR34',
        'E1SE34',
        'E1XC34monde',
        'EXGR34',
        'E1XP34',
        'E1XR34',
        'EXXO34',
        'F1FI34',
        'FBOK34',
        'FASL34',
        'F1SL34',
        'F1RI34',
        'F1NI34',
        'FFTD34',
        'F1RC34',
        'FSLR34',
        'F1EC34',
        'F1IS34',
        'FLTC34',
        'F1LI34',
        'F1LS34',
        'F1MC34',
        'FDMO34',
        'F1TN34',
        'F1TV34',
        'F1BH34',
        'FOXC34',
        'F1RA34',
        'FCXO34',
        'FMSC34',
        'G1LP34',
        'GPSI34',
        'G1RM34',
        'G1AR34',
        'G1DS34',
        'GEOO34',
        'G1MI34',
        'GMCO34',
        'G1PC34',
        'GPRK34',
        'GILD34',
        'G1SK34',
        'G1PI34',
        'G1LL34',
        'G1FI34',
        'GSGI34',
        'GPRO34',
        'H1RB34',
        'HALI34',
        'H1BI34',
        'THGI34',
        'H1OG34',
        'H1IG34',
        'H1AS34',
        'H1CA34',
        'H1DB34',
        'P1EA34',
        'H1EI34',
        'H1SI34',
        'HSHY34',
        'H1ES34',
        'H1PE34',
        'H1LT34',
        'H1FC34',
        'H1OL34',
        'HOME34',
        'HOND34',
        'H1ZN34',
        'H1RL34',
        'H1ST34',
        'ARNC34',
        'H1SB34',
        'H1TH34',
        'H1UM34',
        'H1BA34',
        'H1II34',
        'I1AC34',
        'I1BN34',
        'I1EX34',
        'I1DX34',
        'I1NF34',
        'I1TW34',
        'I1LM34',
        'I1NC34',
        'I1FO34',
        'INGG3',
        'I1RP34',
        'ITLC34',
        'I1CE34',
        'I1HG34',
        'I1PC34',
        'I1FF34',
        'I1PH34',
        'INTU34',
        'I1SR34',
        'I1VZ34',
        'ISBC34',
        'I1PG34',
        'I1QY34',
        'I1QV34',
        'I1RM34',
        'J1KH34',
        'J1EG34',
        'J1BH34',
        'JDCO34',
        'J1EF34',
        'J1CI34',
        'JPMC34',
        'J1NP34',
        'K1CS34',
        'K1BF34',
        'K1EL34',
        'KMPR34',
        'K1EY34',
        'K1SG34',
        'K1IM34',
        'KMIC34',
        'K1LA34',
        'K1SS34',
        'PHGN34',
        'K1RC34',
        'K1TC34',
        'LBRN34',
        'L1HX34',
        'L1CA34',
        'L1RC34',
        'L1WH34',
        'L1VS34',
        'L1EG34',
        'L1DO34',
        'L1EN34',
        'LBRD34',
        'L1BT34',
        'L1BT35',
        'LSXM34',
        'LSXM35',
        'LILY34',
        'L1NC34',
        'L1IN34',
        'L1YV34',
        'L1KQ34',
        'L1YG34',
        'L1OE34',
        'LOWC34',
        'L1UL34',
        'L1MN34',
        'L1YB34',
        'M1TB34',
        'MACY34',
        'M1RO34',
        'M1PC34',
        'MKLC34',
        'M1KT34',
        'M1TT34',
        'M1MC34',
        'M1LM34',
        'M1AS34',
        'M1TC34',
        'M1XI34',
        'M1KC34',
        'MCDC34',
        'M1CK34',
        'MDTC34',
        'M1LC34',
        'MELI34',
        'MRCK34',
        'M1TD34',
        'M1GM34',
        'M1CH34',
        'MUTC34',
        'MSFT34',
        'M1AA34',
        'M1UF34',
        'M1BT34',
        'M1RN34',
        'M1HK34',
        'M1CB34',
        'MDLZ34',
        'M1DB34',
        'M1NS34',
        'MCOR34',
        'MOSC34',
        'M1SI34',
        'M1SC34',
        'N1DA34',
        'N1GG34',
        'N1OV34',
        'N1WG34',
        'N1TA34',
        'NETE34',
        'NFLX34',
        'N1BI34',
        'E1DU34',
        'N1WL34',
        'N1EM34',
        'N1WS34',
        'N1WS35',
        'NEXT34',
        'N1IC34',
        'N1LS34',
        'N1IS34',
        'NOKI34',
        'NMRH34',
        'J1WN34',
        'N1SC34',
        'N1TR34',
        'NOCG34',
        'N1CL34',
        'N1VS34',
        'N1VO34',
        'N1RG34',
        'N1UE34',
        'NVDC34',
        'N1VR34',
        'N1XP34',
        'OXYP34',
        'O1KT34',
        'O1DF34',
        'O1MC34',
        'O1KE34',
        'ORLY34',
        'I1XC34',
        'O1TI34',
        'P1AC34',
        'P1KG34',
        'P1HC34',
        'P1AY34',
        'P1YC34',
        'PYPL34',
        'P1NR34',
        'P1BC34',
        'P1KI34',
        'P1RG34',
        'PTCH34',
        'PFIZ34',
        'PGCO34',
        'PHMO34',
        'P1SX34',
        'P1DD34',
        'P1NW34',
        'P1IO34',
        'PNCS34',
        'P1KX34',
        'P1PG34',
        'P1PL34',
        'P1FG34',
        'P1LD34',
        'P1DT34',
        'P1UK34',
        'T1LK34',
        'P1EG34',
        'P1SA34',
        'P1HM34',
        'P1VH34',
        'Q1RV34',
        'QCOM34',
        'Q1UA34',
        'Q1UE34',
        'R1LC34',
        'R1JF34',
        'RDSA34',
        'R1IN34',
        'R1EG34',
        'REGN34',
        'R1FC34',
        'R1EL34',
        'R1SG34',
        'R1MD34',
        'RIOT34',
        'R1HI34',
        'R1OK34',
        'R1KU34',
        'R1OL34',
        'R1OP34',
        'ROST34',
        'R1CL34',
        'RDSA35',
        'R1YA34',
        'SPGI34',
        'SSFO34',
        'BCSA34',
        'SAPP34',
        'S1RP34',
        'S1BA34',
        'SCHW34',
        'S1TX34',
        'S1EA34',
        'S1GE34',
        'S1RE34',
        'N1OW34',
        'S1BS34',
        'SBNY34',
        'SIMN34',
        'SRXM34',
        'S1KM34',
        'S1SL34',
        'S1LG34',
        'S1NN34',
        'S1NA34',
        'SNEC34',
        'S1OU34',
        'S1PL34',
        'S1PO34',
        'S1SN34',
        'S1WK34',
        'S1TT34',
        'S1TE34',
        'SLBC34',
        'STMN34',
        'S1YK34',
        'S1MF34',
        'S1IV34',
        'S1YM34',
        'S1YF34',
        'S1NP34',
        'S1YY34',
        'T1RO34',
        'TSMC34',
        'TAKP34',
        'T1TW34',
        'T1AL34',
        'TPRY34',
        'T1EL34',
        'T1EC34',
        'T1FX34',
        'TLNC34',
        'T1SS34',
        'TXSA34',
        'TSLA34',
        'T1EV34',
        'T1XT34',
        'S1JM34',
        'P1GR34',
        'S1HW34',
        'T1SO34',
        'TMOS34',
        'TJXC34',
        'T1MU34',
        'TMCO34',
        'T1SC34',
        'T1DG34',
        'RIGG34',
        'TRVC34',
        'T1RI34',
        'T1WL34',
        'TWTR34',
        'TSNF34',
        'U1BE34',
        'UBSG34',
        'U1DR34',
        'U1LT34',
        'U1AI34',
        'ULEV34',
        'U1NL34',
        'UPAC34',
        'U1AL34',
        'U1RI34',
        'UNHH34',
        'U1HS34',
        'U1NM34',
        'UPSS34',
        'USSX34',
        'VLOE34',
        'VLYB34',
        'V1AR34',
        'V1TA34',
        'VRSN34',
        'V1RS34',
        'VERZ34',
        'VRTX34',
        'VFCO34',
        'V1IP34',
        'V1OD34',
        'V1NO34',
        'V1MC34',
        'W1AB34',
        'WALM34',
        'WGBA34',
        'W1MG34',
        'W1MC34',
        'WATC34',
        'W1SO34',
        'W1EC34',
        'W1BO34',
        'WFCO34',
        'W1EL34',
        'WABC34',
        'W1DC34',
        'WUNI34',
        'W1BK34',
        'W1RK34',
        'W1YC34',
        'W1HR34',
        'W1MB34',
        'W1LT34',
        'W1IX34',
        'W1DA34',
        'W1PP34',
        'W1RB34',
        'G1WW34',
        'W1YN34',
        'X1EL34',
        'X1LN34',
        'X1YL34',
        'YUMR34',
        'Z1BR34',
        'Z1BH34',
        'Z1IO34',
        'Z1TS34',
        'Z1OM34',
        'Z1TO34',
        'ACNB34',
        'AIGB34',
        'AXPB34',
        'ATTB34',
        'BERK34',
        'BONY34',
        'BOEI34',
        'BMYB34',
        'DUKB34',
        'DDNB34',
        'FDXB34',
        'FMXB34',
        'GDBR34',
        'HONB34',
        'HPQB34',
        'IBMB34',
        'JNJB34',
        'KMBB34',
        'KHCB34',
        'LMTB34',
        'METB34',
        'MSBR34',
        'PEPB34',
        'SBUB34',
        'TGTB34',
        'TEXA34',
        'VISA34',
        'DISB34',
        'XRXB34',
        'AMZO34',
        'CATP34',
        'CHVX34',
        'COCA34',
        'COLG34',
        'MSCD34',
        'NIKE34',
        'ORCL34',
        'RYTT34',
        'SLBG34',
        'TIFF34',
        'USBC34',
    ]
    resultados = []
    for ticker in acoes_br:
        print(f"Buscando dados para {ticker}...")
        dados = buscar_dados_acao(ticker)
        if dados:
            resultados.append(dados)

    # Criar DataFrame com os resultados
    df = pd.DataFrame(resultados)
    print("\nDados das Ações:")
    print(df.to_string(index=False))

    # Salvar em CSV
    df.to_csv('retorno/dados_acoes.csv', index=False, encoding='utf-8-sig')
    print("\nDados salvos em 'retorno/dados_acoes.csv'")


# def inicio():
#     MENU = {'1': {'title': 'listar Acoes brasileiras',
#                   'function': listar_acoes_brasileiras}}

#     menuTelas(MENU)


# Ler e mesclar
# Ler e mesclar
# Ler e mesclar
df1 = pd.read_excel('C:/Users/lucas/Downloads/Pasta1.xlsx')
df2 = pd.read_excel('C:/Users/lucas/Downloads/Pasta2.xlsx')

merged = pd.merge(df1, df2, on='Ticker', how='outer', suffixes=('_1', '_2'))

for col in ['Nome', 'Setor', 'Segmento', 'País']:
    merged[col] = np.where(
        (merged[f'{col}_1'].notna() & (merged[f'{col}_1'] != '')),
        merged[f'{col}_1'],
        merged[f'{col}_2']
    )

# Criar uma cópia explícita para evitar o warning
resultado = merged[['Ticker', 'Nome', 'Setor', 'Segmento', 'País']].copy()

# Traduzir apenas valores únicos
translator = GoogleTranslator(source='auto', target='pt')


def traduzir_valores_unicos(coluna):
    valores_unicos = resultado[coluna].dropna().unique()
    traducao_dict = {}

    for valor in valores_unicos:
        try:
            if valor != '':
                traducao_dict[valor] = translator.translate(str(valor))
            else:
                traducao_dict[valor] = valor
        except Exception as e:
            print(f"Erro ao traduzir '{valor}': {e}")
            traducao_dict[valor] = valor

    return traducao_dict


# Usar .loc para atribuir valores
traducao_setor = traduzir_valores_unicos('Setor')
resultado.loc[:, 'Setor'] = resultado['Setor'].map(
    lambda x: traducao_setor.get(x, x))

traducao_segmento = traduzir_valores_unicos('Segmento')
resultado.loc[:, 'Segmento'] = resultado['Segmento'].map(
    lambda x: traducao_segmento.get(x, x))

# Salvar
resultado.to_excel('C:/Users/lucas/Downloads/planilha_final.xlsx', index=False)
